schemaVersion: 2.2.2
metadata:
  name: xmas-rhcl-shop
  version: 1.0.0
  displayName: Arencloud Xmas RHCL Shop
  description: Quarkus + Camel + Keycloak app with Kaoto + Kuadrant samples
components:
  - name: tools
    container:
      image: quay.io/devfile/universal-developer-image:latest
      memoryRequest: 2Gi
      memoryLimit: 4Gi
      cpuRequest: 500m
      cpuLimit: 2000m
commands:
  - id: init-setup
    exec:
      label: '01: initial setup'
      component: "tools"
      workingDir: "${PROJECT_SOURCE}"
      commandLine: |
        git config --global core.filemode false
        echo "source /usr/share/bash-completion/completions/git" >> /home/user/.bashrc
        oc completion bash > /home/user/.oc_bash_completion
        echo "source /home/user/.oc_bash_completion" >> /home/user/.bashrc
  - id: oc-login
    exec:
      label: '02: OC Login'
      component: "tools"
      commandLine: |
        clear
        echo
        echo "current user: $(oc whoami)"
        echo "current project: $(oc project)"
        echo
        oc login "https://$KUBERNETES_SERVICE_HOST:443" --insecure-skip-tls-verify=true
events:
  postStart:
    - init-setup